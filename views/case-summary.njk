{% extends "partials/case-details.njk" %}

{%- set communityData = data.communityData -%}

{% block caseContent %}

    <div class="govuk-grid-row">
        <div class="govuk-grid-column-full">
            <h1 class="govuk-heading-l">Case details</h1>
        </div>
    </div>

    <div class="govuk-grid-row">
        <div class="govuk-grid-column-two-thirds">

            <h2 class="govuk-heading-m">Appearance</h2>
            <p class="govuk-body">Court {{ data.courtRoom }}, {{ data.session | lower }} session,
                {{ params.moment(data.sessionStartTime).format('dddd Do MMMM') }} ({{ data.listNo }}
                listing).</p>

            <h2 class="govuk-heading-m govuk-!-margin-top-9">Offences</h2>


            {% set offences = [] %}
            {% for offence in data.offences %}
                {{ offences.push(data.offences) | length }}
            {% endfor %}
            {% if offences | length < 2 %}
                {% for offence in data.offences %}
                    <p class="govuk-body govuk-!-font-weight-bold">{{ offence.offenceTitle }}</p>
                    <p class="govuk-body govuk-!-margin-bottom-0">{{ offence.offenceSummary }}</p>
                    <p class="govuk-caption-m govuk-!-margin-top-3">{{ offence.act }}</p>
                {% endfor %}
                {% elif offences | length > 1 %}
                <div class="govuk-accordion" data-module="govuk-accordion">
                    {% for offence in data.offences %}
                        <div class="govuk-accordion__section ">
                            <div class="govuk-accordion__section-header">
                                <h2 class="govuk-accordion__section-heading">
                                    <span class="govuk-accordion__section-button govuk-!-font-size-19">{{ offence.offenceTitle }}</span>
                                </h2>
                            </div>
                            <div class="govuk-accordion__section-content">
                                <p class="govuk-body govuk-!-margin-bottom-0">{{ offence.offenceSummary }}</p>
                                <p class="govuk-caption-m govuk-!-margin-top-3">{{ offence.act }}</p>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% endif %}


            <h2 class="govuk-heading-m govuk-!-margin-top-9">
                Personal details from police
            </h2>

            <dl class="govuk-summary-list govuk-summary-list--no-border">
                <div class="govuk-summary-list__row">
                    <dt class="govuk-summary-list__key">
                        Name
                    </dt>
                    <dd class="govuk-summary-list__value">
                        {{ data.defendantName }}
                    </dd>
                </div>
                <div class="govuk-summary-list__row">
                    <dt class="govuk-summary-list__key">
                        Gender
                    </dt>
                    <dd class="govuk-summary-list__value">
                        {% if data.defendantSex === "F" %}Female{% elif data.defendantSex === "M" %}Male{% else %}Unknown{% endif %}
                    </dd>
                </div>
                <div class="govuk-summary-list__row">
                    <dt class="govuk-summary-list__key">
                        Date of birth
                    </dt>
                    <dd class="govuk-summary-list__value">
                        {{ params.moment(data.defendantDob, 'DD-MM-YYYY').format('D MMMM YYYY') }}
                        ({{ params.moment().diff(params.moment(data.defendantDob, 'DD-MM-YYYY'), 'years') }} years old)
                    </dd>
                </div>
                <div class="govuk-summary-list__row">
                    <dt class="govuk-summary-list__key">
                        Address
                    </dt>
                    <dd class="govuk-summary-list__value">
                        {%- set address = data.defendantAddress -%}
                        {% if address.line1 %}{{ address.line1 }}<br/>{% endif %}
                        {% if address.line2 %}{{ address.line2 }}<br/>{% endif %}
                        {% if address.line3 %}{{ address.line3 }}<br/>{% endif %}
                        {% if address.line4 %}{{ address.line4 }}<br/>{% endif %}
                        {% if address.line5 %}{{ address.line5 }}<br/>{% endif %}
                        {% if address.postcode %}{{ address.postcode | upper }}{% endif %}
                    </dd>
                </div>
                <div class="govuk-summary-list__row">
                    <dt class="govuk-summary-list__key">
                        Nationality
                    </dt>
                    <dd class="govuk-summary-list__value">
                        {{ data.nationality_1 or "Unknown" }}{{ " / " + data.nationality_2 if data.nationality_2 }}
                    </dd>
                </div>
            </dl>

        </div>
        <div class="govuk-grid-column-one-third">

            <h3 class="govuk-heading-s">CPS pack</h3>
            <p class="govuk-body"><a href="#" class="govuk-link govuk-link--no-visited-state">View CPS Pack (opens in
                    Court Store)</a></p>

        </div>
    </div>

{% endblock %}
